import difflib,textwrap,sys
from parse_string import parse_text_into_list_of_seqs

def joinseqswithoverlap(seqs, limit=30):    
    overlap = 199
    while len(seqs)>1:
        b=seqs.pop()
        a=seqs.pop()
        ThreePrimeEndOfa =a[-overlap:]
        FivePrimeEndOfb  =b[:overlap]
        s = difflib.SequenceMatcher(None, ThreePrimeEndOfa.lower(), FivePrimeEndOfb.lower())
        m = s.find_longest_match(0,len(ThreePrimeEndOfa),0,len(FivePrimeEndOfb))        
        if m.size<limit:
            sys.exit("overlap between sequences is lower than "+str(limit))
        seqs.append(a[:-(overlap-m.a)]+b[m.b:])
    return seqs[0]

if __name__=="__main__":    
    text = textwrap.dedent('''                           
    >pRHT373
    GACGAAAGGGCCTCGTGATACGCCTATTTTTATAGGTTAATGTCATGATAATAATGGTTTCTTAGGACGGATCGCTTGCCTGTAACTTACACGCGCCTCGTATCTTTTAATGATGGAATAATTTGGGAATTTACTCTGTGTTTATTTATTTTTATGTTTTGTATTTGGATTTTAGAAAGTAAATAAAGAAGGTAGAAGAGTTACGGAATGAAGAAAAAAAAATAAACAAAGGTTTAAAAAATTTCAACAAAAAGCGTACTTTACATATATATTTATTAGACAAGAAAAGCAGATTAAATAGATATACATTCGATTAACGATAAGTAAAATGTAAAATCACAGGATTTTCGTGTGTGGTCTTCTACACAGACAAGATGAAACAATTCGGCATTAATACCTGAGAGCAGGAAGAGCAAGATAAAAGGTAGTATTTGTTGGCGATCCCCCTAGAGTCTTTTACATCTTCGGAAAACAAAAACTATTTTTTCTTTAATTTCTTTTTTTACTTTCTATTTTTAATTTATATATTTATATTAAAAAATTTAAATTATAATTATTTTTATAGCACGTGATGAAAAGGACCCAGGTGGCACTTTTCGGGGAAATGTGCGCGGAACCCCTATTTGTTTATTTTTCTAAATACATTCAAATATGTATCCGCTCATGAGACAATAACCCTGATAAATGCTTCAATAATATTGAAAAAGGAAGAGTATGAGTATTCAACATTTCCGTGTCGCCCTTATTCCCTTTTTTGCGGCATTTTGCCTTCCTGTTTTTGCTCACCCAGAAACGCTGGTGAAAGTAAAAGATGCTGAAGATCAGTTGGGTGCACGAGTGGGTTACATCGAACTGGATCTCAACAGCGGTAAGATCCTTGAGAGTTTTCGCCCCGAAGAACGTTTTCCAATGATGAGCACTTTTAAAGTTCTGCTATGTGGCGCGGTATTATCCCGTATTGACGCCGGGCAAGAGCAACTCGGTCGCCGCATACACTATTCTCAGAATGACTTGGTTGAGTACTCACCAGTCACAGAAAAGCATCTTACGGATGGCATGACAGTAAGAGAATTATGCAGTGCTGCCATAACCATGAGTGATAACACTGCGGCCAACTTACTTCTGACAACGATCGGAGGACCGAAGGAGCTAACCGCTTTTTTGCACAACATGGGGGATCATGTAACTCGCCTTGATCGTTGGGAACCGGAGCTGAATGAAGCCATACCAAACGACGAGCGTGACACCACGATGCCTGTAGCAATGGCAACAACGTTGCGCAAACTATTAACTGGCGAACTACTTACTCTAGCTTCCCGGCAACAATTAATAGACTGGATGGAGGCGGATAAAGTTGCAGGACCACTTCTGCGCTCGGCCCTTCCGGCTGGCTGGTTTATTGCTGATAAATCTGGAGCCGGTGAGCGTGGGTCTCGCGGTATCATTGCAGCACTGGGGCCAGATGGTAAGCCCTCCCGTATCGTAGTTATCTACACGACGGGGAGTCAGGCAACTATGGATGAACGAAATAGACAGATCGCTGAGATAGGTGCCTCACTGATTAAGCATTGGTAACTGTCAGACCAAGTTTACTCATATATACTTTAGATTGATTTAAAACTTCATTTTTAATTTAAAAGGATCTAGGTGAAGATCCTTTTTGATAATCTCATGACCAAAATCCCTTAACGTGAGTTTTCGTTCCACTGAGCGTCAGACCCCGTAGAAAAGATCAAAGGATCTTCTTGAGATCCTTTTTTTCTGCGCGTAATCTGCTGCTTGCAAACAAAAAAACCACCGCTACCAGCGGTGGTTTGTTTGCCGGATCAAGAGCTACCAACTCTTTTTCCGAAGGTAACTGGCTTCAGCAGAGCGCAGATACCAAATACTGTCCTTCTAGTGTAGCCGTAGTTAGGCCACCACTTCAAGAACTCTGTAGCACCGCCTACATACCTCGCTCTGCTAATCCTGTTACCAGTGGCTGCTGCCAGTGGCGATAAGTCGTGTCTTACCGGGTTGGACTCAAGACGATAGTTACCGGATAAGGCGCAGCGGTCGGGCTGAACGGGGGGTTCGTGCACACAGCCCAGCTTGGAGCGAACGACCTACACCGAACTGAGATACCTACAGCGTGAGCTATGAGAAAGCGCCACGCTTCCCGAAGGGAGAAAGGCGGACAGGTATCCGGTAAGCGGCAGGGTCGGAACAGGAGAGCGCACGAGGGAGCTTCCAGGGGGAAACGCCTGGTATCTTTATAGTCCTGTCGGGTTTCGCCACCTCTGACTTGAGCGTCGATTTTTGTGATGCTCGTCAGGGGGGCGGAGCCTATGGAAAAACGCCAGCAACGCGGCCTTTTTACGGTTCCTGGCCTTTTGCTGGCCTTTTGCTCACATGTTCTTTCCTGCGTTATCCCCTGATTCTGTGGATAACCGTATTACCGCCTTTGAGTGAGCTGATACCGCTCGCCGCAGCCGAACGACCGAGCGCAGCGAGTCAGTGAGCGAGGAAGCGGAAGAGCGCCCAATACGCAAACCGCCTCTCCCCGCGCGTTGGCCGATTCATTAATGCAGCTGGCACGACAGGTTTCCCGACTGGAAAGCGGGCAGTGAGCGCAACGCAATTAATGTGAGTTACCTCACTCATTAGGCACCCCAGGCTTTACACTTTATGCTTCCGGCTCCTATGTTGTGTGGAATTGTGAGCGGATAACAATTTCACACAGGAAACAGCTATGACCATGATTACGCCAAGCGCGCAATTAACCCTCACTAAAGGGAACAAAAGCTGGAGCTCTTGAAGTACGGATTAGAAGCCGCCGAGCGGGCGACAGCCCTCCGACGGAAGACTCTCCTCCGTGCGTCCTCGTCTTCACCGGTCGCGTTCCTGAAACGCAGATGTGCCTCGCGCCGCACTGCTCCGAACAATAAAGATTCTACAATACTAGCTTTTATGGTTATGAAGAGGAAAAATTGGCAGTAACCTGGCCCCACAAACCTTCAAATTAACGAATCAAATTAACAACCATAGGATGATAATGCGATTAGTTTTTTAGCCTTATTTCTGGGGTAATTAATCAGCGAAGCGATGATTTTTGATCTATTAACAGATATATAAATGGAAAAGCTGCATAACCACTTTAACTAATACTTTCAACATTTTCAGTTTGTATTACTTCTTATTCAAATGTCATAAAAGTATCAACAAAAAATTGTTAATATACCTCTATACTTTAACGTCAAGGAGAAAAAACTATATCTAGAACTAGTGGATCCATGTCGTCGTCAATTACAGATGAGAAAATATCTGGTGAACAGCAACAACCTGCTGGCAGAAAACTATACTATAACACAAGTACATTTGCAGAGCCTCCTCTAGTGGACGGAGAAGGTAACCCTATAAATTATGAGCCGGAAGTTTACAACCCGGATCACGAAAAGCTATACCATAACCCATCACTGCCTGCACAATCAATTCAGGATACAAGAGATGATGAATTGCTGGAAAGAGTTTATAGCCAGGATCAAGGTGTAGAGTATGAGGAAGATGAAGAGGATAAGCCAAACCTAAGCGCTGCGTCCATTAAAAGTTATGCTTTAACGAGATTTACGTCCTTACTGCACATCCACGAGTTTTCTTGGGAGAATGTCAATCCCATACCCGAACTGCGCAAAATGACATGGCAGAATTGGAACTATTTTTTTATGGGTTATTTTGCGTGGTTGTCTGCGGCTTGGGCCTTCTTTTGCGTTTCAGTATCAGTCGCTCCATTGGCTGAACTATATGACAGACCAACCAAGGACATCACCTGGGGGTTGGGATTGGTGTTATTTGTTCGTTCAGCAGGTGCTGTCATATTTGGTTTATGGACAGATAAGTCTTCCAGAAAGTGGCCGTACATTACATGTTTGTTCTTATTTGTCATTGCACAACTCTGTACTCCATGGTGTGACACATACGAGAAATTTCTGGGCGTAAGGTGGATAACCGGTATTGCTATGGGAGGAATTTACGGATGTGCTTCTGCAACAGCGATTGAAGATGCACCTGTGAAAGCACGTTCGTTCCTATCAGGTCTATTTTTTTCTGCTTACGCTATGGGGTTCATATTTGCTATCATTTTTTACAGAGCCTTTGGCTACTTTAGGGATGATGGCTGGAAAATATTGTTTTGGTTTAGTATTTTTCTACCAATTCTACTAATTTTCTGGAGATTGTTATGGCCTGAAACGAAATACTTCACCAAGGTTTTGAAAGCCCGTAAATTAATATTGAGTGACGCAGTGAAAGCTAATGGTGGCGAGCCTCTACCAAAAGCCAACTTTAAACAAAAGATGGTATCCATGAAGAGAACAGTTCAAAAGTACTGGTTGTTGTTCGCATATTTGGTTGTTTTATTGGTGGGTCCAAATTACTTGACTCATGCTTCTCAAGACTTGTTGCCAACCATGCTGCGTGCCCAATTAGGCCTATCCAAGGATGCTGTCACTGTCATTGTAGTGGTTACCAACATCGGTGCTATTTGTGGGGGTATGATATTTGGACAGTTCATGGAAGTTACTGGAAGAAGATTAGGCCTATTGATTGCATGCACAATGGGTGGTTGCTTCACCTACCCTGCATTTATGTTGAGAAGCGAAAAGGCTATATTAGGTGCCGGTTTCATGTTATATTTTTGTGTCTTTGGTGTCTGGGGTATCCTGCCCATTCACCTTGCAGAGTTGGCCCCTGCTGATGCAAGGGCTTTGGTTGCCGGTTTATCTTACCAGCTAGGTAATCTAGCTTCTGCAGCGGCTTCCACGATTGAGACACAGTTAGCTGATAGATACCCATTAGAAAGAGATGCCTCTGGTGCTGTGATTAAAGAAGATTATGCCAAAGTTATGGCTATCTTGACTGGTTCTGTTTTCATCTTCACATTTGCTTGTGTTTTTGTTGGCCATGAGAAATTCCATCGTGATTTGTCCTCTCCTGTTATGAAGAAATATATAAACCAAGTGGAAGAATACGAAGCCGATGGTCTTTCGATTAGTGACATTGTTGAACAAAAGACGGAATGTGCTTCAGTGAAGATGATTGATTCGAACGTCTCAAAGACATATGAGGAGCATATTGAGACCGTTGAATTCGATATCAAGCTTGTCGACATGAGTAAAGGAGAAGAACTTTTCACTGGAGTTGTCCCAATTCTTGTTGAATTAGATGGTGATGTTAATGGGCACAAATTTTCTGTCAGTGGAGAGGGTGAAGGTGATGCAACATACGGAAAACTTACCCTTAAATTTATTTGCACTACTGGAAAACTACCTGTTCCATGGCCAACACTTGTCACTACTTTCACTTATGGTGTTCAATGCTTTTCAAGATACCCAGATCATATGAAACGGCATGACTTTTTCAAGAGTGCCATGCCCGAAGGTTATGTACAGGAAAGAACTATATTTTTCAAAGATGACGGGAACTACAAGACACGTGCTGAAGTCAAGTTTGAAGGTGATACCCTTGTTAATAGAATCGAGTTAAAAGGTATTGATTTTAAAGAAGATGGAAACATTCTTGGACACAAATTGGAATACAACTATAACTCACACAATGTATACATCATGGCAGACAAACAAAAGAATGGAATCAAAGTTAACTTCAAAATTAGACACAACATTGAAGATGGAAGCGTTCAACTAGCAGACCATTATCAACAAAATACTCCAATTGGCGATGGCCCTGTCCTTTTACCAGACAACCATTACCTGTCCACACAATCTGCCCTTTCGAAAGATCCCAACGAAAAGAGAGACCACATGGTCCTTCTTGAGTTTGTAACAGCTGCTGGGATTACACATGGCATGGATGAACTATACAAACACCATCACCATCACCATTAGCTCGAGTCATGTAATTAGTTATGTCACGCTTACATTCACGCCCTCCCCCCACATCCGCTCTAACCGAAAAGGAAGGAGTTAGACAACCTGAAGTCTAGGTCCCTATTTATTTTTTTATAGTTATGTTAGTATTAAGAACGTTATTTATATTTCAAATTTTTCTTTTTTTTCTGTACAGACGCGTGTACGCATGTAACATTATACTGAAAACCTTGCTTGAGAAGGTTTTGGGACGCTCGAAGGCTTTAATTTGCGGCCGGTACCCAATTCGCCCTATAGTGAGTCGTATTACGCGCGCTCACTGGCCGTCGTTTTACAACGTCGTGACTGGGAAAACCCTGGCGTTACCCAACTTAATCGCCTTGCAGCACATCCCCCTTTCGCCAGCTGGCGTAATAGCGAAGAGGCCCGCACCGATCGCCCTTCCCAACAGTTGCGCAGCCTGAATGGCGAATGGCGCGACGCGCCCTGTAGCGGCGCATTAAGCGCGGCGGGTGTGGTGGTTACGCGCAGCGTGACCGCTACACTTGCCAGCGCCCTAGCGCCCGCTCCTTTCGCTTTCTTCCCTTCCTTTCTCGCCACGTTCGCCGGCTTTCCCCGTCAAGCTCTAAATCGGGGGCTCCCTTTAGGGTTCCGATTTAGTGCTTTACGGCACCTCGACCCCAAAAAACTTGATTAGGGTGATGGTTCACGTAGTGGGCCATCGCCCTGATAGACGGTTTTTCGCCCTTTGACGTTGGAGTCCACGTTCTTTAATAGTGGACTCTTGTTCCAAACTGGAACAACACTCAACCCTATCTCGGTCTATTCTTTTGATTTATAAGGGATTTTGCCGATTTCGGCCTATTGGTTAAAAAATGAGCTGATTTAACAAAAATTTAACGCGAATTTTAACAAAATATTAACGTTTACAATTTCCTGATGCGGTATTTTCTCCTTACGCATCTGTGCGGTATTTCACACCGCATAGGGTAATAACTGATATAATTAAATTGAAGCTCTAATTTGTGAGTTTAGTATACATGCATTTACTTATAATACAGTTTTTTAGTTTTGCTGGCCGCATCTTCTCAAATATGCTTCCCAGCCTGCTTTTCTGTAACGTTCACCCTCTACCTTAGCATCCCTTCCCTTTGCAAATAGTCCTCTTCCAACAATAATAATGTCAGATCCTGTAGAGACCACATCATCCACGGTTCTATACTGTTGACCCAATGCGTCTCCCTTGTCATCTAAACCCACACCGGGTGTCATAATCAACCAATCGTAACCTTCATCTCTTCCACCCATGTCTCTTTGAGCAATAAAGCCGATAACAAAATCTTTGTCGCTCTTCGCAATGTCAACAGTACCCTTAGTATATTCTCCAGTAGATAGGGAGCCCTTGCATGACAATTCTGCTAACATCAAAAGGCCTCTAGGTTCCTTTGTTACTTCTTCTGCCGCCTGCTTCAAACCGCTAACAATACCTGGGCCCACCACACCGTGTGCATTCGTAATGTCTGCCCATTCTGCTATTCTGTATACACCCGCAGAGTACTGCAATTTGACTGTATTACCAATGTCAGCAAATTTTCTGTCTTCGAAGAGTAAAAAATTGTACTTGGCGGATAATGCCTTTAGCGGCTTAACTGTGCCCTCCATGGAAAAATCAGTCAAGATATCCACATGTGTTTTTAGTAAACAAATTTTGGGACCTAATGCTTCAACTAACTCCAGTAATTCCTTGGTGGTACGAACATCCAATGAAGCACACAAGTTTGTTTGCTTTTCGTGCATGATATTAAATAGCTTGGCAGCAACAGGACTAGGATGAGTAGCAGCACGTTCCTTATATGTAGCTTTCGACATGATTTATCTTCGTTTCCTGCAGGTTTTTGTTCTGTGCAGTTGGGTTAAGAATACTGGGCAATTTCATGTTTCTTCAACACTACATATGCGTATATATACCAATCTAAGTCTGTGCTCCTTCCTTCGTTCTTCCTTCTGTTCGGAGATTACCGAATCAAAAAAATTTCAAAGAAACCGAAATCAAAAAAAAGAATAAAAAAAAAATGATGAATTGAATTGAAAAGCTGTGGTATGGTGCACTCTCAGTACAATCTGCTCTGATGCCGCATAGTTAAGCCAGCCCCGACACCCGCCAACACCCGCTGACGCGCCCTGACGGGCTTGTCTGCTCCCGGCATCCGCTTACAGACAAGCTGTGACCGTCTCCGGGAGCTGCATGTGTCAGAGGTTTTCACCGTCATCACCGAAACGCGCGA
    ''')
    seqlist =  [a.record.seq for a in parse_text_into_list_of_seqs(text)]
    pRHT373 = seqlist[0]
    
    from Bio.Restriction import BamHI

    vectorfragments = BamHI.catalyse(pRHT373)

    text = textwrap.dedent(''' 
    >PCR product (363 bp) primers FNT-JEN1-GAP1 and RNT-JEN1-GAP1
    CTTTAACGTCAAGGAGAAAAAACTATATCTAGAACTAGTGGATCCatgagtaatacttcttcgtacgagaagaatAATCCAGATAATCTGAAACACAATGGTATTACCATAGATTCTGAGTTTCTAACTCAGGAGCCAATAACCATTCCCTCAAATGGCTCCGCTGTTTCTATTGACGAAACAGGTTCAGGGTCCAAATGGCAAGACTTTAAAGATTCTTTCAAAAGGGTAAAACCTATTGAAGTTGATCCTAATCTTTCAGAAGCTGAAAAAGTGGCTATCATCACTGCCCAaactccattgaagcaccacttgaagATGACATGGCAGAATTGGAACTATTTTTTTATGGGTTATTTTGCG
    >PCR product (417 bp) primers FNT-JEN1-FUR4 and RNT-JEN1-FUR4
    CTTTAACGTCAAGGAGAAAAAACTATATCTAGAACTAGTGGATCCatgccagacaatctatcattacatttaagcggcTCTTCAAAAAGATTGAACTCTCGCCAACTTATGGAATCTTCCAATGAGACCTTTGCGCCAAATAATGTGGATTTGGAAAAAGAGTATAAGTCATCTCAGAGTAATATAACTACCGAAGTTTATGAGGCATCGAGCTTTGAAGAAAAAGTAAGCTCAGAAAAACCTCAATACAGCTCATTCTGGAAGAAAATCTATTATGAATATGTGGTCGTTGACAAATCAATCTTGGGTGTTTCTATTCTGGATTCATTTATGTACAACCAGGACTTgaagcccgtcgaaaaagaaaggcggATGACATGGCAGAATTGGAACTATTTTTTTATGGGTTATTTTGCG
    >PCR product (264 bp) primers FNT-JEN1-HXT6 and RNT-JEN1-HXT6
    CTTTAACGTCAAGGAGAAAAAACTATATCTAGAACTAGTGGATCCatgtcacaagacgctgctattgcagAGCAAACTCCTGTGGAGCATCTCTCTGCTGTTGACTCAGCCTCCCACTCGGTTTTATCTACACCATCAAACAAGGCTGAAAGAGATGAAATAAAAGCTTATGGTGAAGGTGAAGAGCACGAACCtgtcgttgaaattccaaagagaccaATGACATGGCAGAATTGGAACTATTTTTTTATGGGTTATTTTGCG
    >PCR product (309 bp) primers FNT-JEN1-UAPA and RNT-JEN1-UAPA
    CTTTAACGTCAAGGAGAAAAAACTATATCTAGAACTAGTGGATCCatggatccctccatccattcaaccgacggccccgactccgtcatccccaactccaaccccaagaagaccgtccgacagagagtccgcttgctggctaggcatctgacgacccgcgagggcctgatcggcgactatgactatggcttccttttccggcccgagctacccttcatgaagaaagatccacgggcgccgcctttttttggcctcaacgagaagATGACATGGCAGAATTGGAACTATTTTTTTATGGGTTATTTTGCG
    ''')
    seqlist =  [a.record.seq for a in parse_text_into_list_of_seqs(text)]
    
    for insert in seqlist:
        #print insert
        print
        print joinseqswithoverlap([vectorfragments[0],insert,vectorfragments[1]])[0:10]
        print
    
    
    
